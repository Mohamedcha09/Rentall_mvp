{% extends "base.html" %}
{% block content %}

<!-- ===== Floating Back Button (iOS Style) ===== -->
<a href="/" class="back-btn-ios">
  <i class="bi bi-chevron-left"></i>
</a>

<style>
/* ======================================================
   BACK BUTTON â€” iOS STYLE
====================================================== */
.back-btn-ios {
    position: fixed;
    top: calc(env(safe-area-inset-top) + 12px);
    left: 14px;
    z-index: 9999;
    background: rgba(255,255,255,0.90);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    width: 42px;
    height: 42px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #222;
    font-size: 20px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    text-decoration: none;
}
.back-btn-ios:active { transform: scale(0.92); }

/* ======================================================
   HIDE NAVBARS
====================================================== */
header.topbar,
.m-top-tabs,
.mobile-tabbar,
nav.desk-tabs,
.stripe-callout {
    display: none !important;
}
body.has-tabbar { padding-bottom: 0 !important; }

/* ======================================================
   AIRBNB STYLE SETTINGS
====================================================== */
.settings-container {
    padding: 26px 20px;
    max-width: 780px;
    margin: auto;
    font-family: system-ui, sans-serif;
}

.settings-title {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 30px;
}

.section-line {
    padding: 16px 0;
    border-bottom: 1px solid #e5e5e5;
}

.section-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.section-label {
    font-size: 18px;
    font-weight: 600;
}

.section-value {
    font-size: 17px;
    color: #444;
    margin-top: 6px;
}

.section-action {
    font-weight: 600;
    color: #222;
    text-decoration: underline;
}

/* ========== EDIT MODE ========== */
.edit-block {
    margin-top: 14px;
}

.edit-description {
    color: #666;
    font-size: 15px;
    margin-bottom: 10px;
    line-height: 1.4;
}

.airbnb-input {
    width: 100%;
    padding: 14px 14px;
    border: 1px solid #ccc;
    border-radius: 10px;
    font-size: 16px;
    margin-bottom: 12px;
}

.save-btn {
    width: 100%;
    padding: 14px;
    background: #111;
    color: white;
    font-size: 17px;
    font-weight: 600;
    border-radius: 10px;
    border: none;
    margin-top: 10px;
}

.cancel-btn {
    font-size: 16px;
    font-weight: 600;
    text-decoration: underline;
    color: #222;
}

/* Fade-out for non-editing sections */
.fade-disabled {
    opacity: 0.35;
}
</style>

<!-- ======================================================
      PAGE CONTENT
====================================================== -->
<div class="settings-container">

  <div class="settings-title">Personal Information</div>

  <!-- ===================== LEGAL NAME ===================== -->
  <div class="section-line {% if editing == 'name' %}{% else %}{% endif %}">
    <div class="section-top">
      <div class="section-label">Legal Name</div>
      <a href="?edit=name" class="section-action">Edit</a>
    </div>
    <div class="section-value">{{ u.first_name }} {{ u.last_name }}</div>

    {% if editing == 'name' %}
    <form method="post" action="/settings/profile" enctype="multipart/form-data" class="edit-block">

      <div class="edit-description">
        Make sure this name matches your official identity documents.
      </div>

      <input class="airbnb-input" 
             name="first_name" 
             placeholder="First name on ID" 
             value="{{ u.first_name }}">

      <input class="airbnb-input"
             name="last_name"
             placeholder="Last name on ID"
             value="{{ u.last_name }}">

      <button class="save-btn">Save</button>
      <a href="/settings" class="cancel-btn">Cancel</a>
    </form>
    {% endif %}
  </div>

  <!-- ===================== DISPLAY NAME ===================== -->
  <div class="section-line {% if editing != 'display' and editing is defined %}fade-disabled{% endif %}">
    <div class="section-top">
      <div class="section-label">Display Name</div>
      <a href="?edit=display" class="section-action">
        {% if u.display_name %}Edit{% else %}Add{% endif %}
      </a>
    </div>
    <div class="section-value">
      {% if u.display_name %}
        {{ u.display_name }}
      {% else %}
        Not provided
      {% endif %}
    </div>

    {% if editing == 'display' %}
    <form method="post" action="/settings/display" class="edit-block">

      <div class="edit-description">
        This name will be shown to renters and owners.
      </div>

      <input class="airbnb-input" 
             name="display_name"
             placeholder="Display name (optional)"
             value="{{ u.display_name or '' }}">

      <button class="save-btn">Save</button>
      <a href="/settings" class="cancel-btn">Cancel</a>
    </form>
    {% endif %}
  </div>

  <!-- ===================== EMAIL ===================== -->
  <div class="section-line {% if editing != 'email' and editing is defined %}fade-disabled{% endif %}">
    <div class="section-top">
      <div class="section-label">Email Address</div>
      <a href="?edit=email" class="section-action">Edit</a>
    </div>
    <div class="section-value">{{ u.email }}</div>

    {% if editing == 'email' %}
    <form method="post" action="/settings/email" class="edit-block">

      <div class="edit-description">
        Use an email address you always have access to.
      </div>

      <input class="airbnb-input"
             type="email"
             name="email"
             placeholder="Email address"
             value="{{ u.email }}">

      <button class="save-btn">Save</button>
      <a href="/settings" class="cancel-btn">Cancel</a>
    </form>
    {% endif %}
  </div>

</div>

{% endblock %}
