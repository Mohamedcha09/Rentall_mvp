{% extends "base.html" %}

{% block head %}
<style>
.method{
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
  transition:.2s ease;
}
.method.active{
  border-color:#6d5dfc;
  background:rgba(109,93,252,.05);
}
.method-title{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:600;
}
.field{margin-top:14px}
.field input, .field select{
  width:100%;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid var(--border);
}
.hint{font-size:.85rem;opacity:.7;margin-top:4px}
</style>
{% endblock %}

{% block content %}
<div class="container" style="max-width:820px">

<h3 class="mb-3">Payout Preferences</h3>

{# âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙ‚Ø· â€” Ø¨Ø¯ÙˆÙ† Ø¨Ø·Ø§Ù‚Ø© #}
{% if payout %}
  <div class="alert alert-info mb-4">
    ğŸ’° <strong>Current payout method:</strong>
    {{ payout.method|upper }} â€” {{ payout.destination }}
  </div>
{% else %}
  <div class="alert alert-warning mb-4">
    âš ï¸ No payout method configured yet.
  </div>
{% endif %}

{% if request.query_params.get("saved") %}
<div class="alert alert-success mb-3">
  âœ… Your payout method has been saved successfully.
</div>
{% endif %}

{# ================= FORM ================= #}
{% if request.query_params.get("edit") == "1" or not payout %}
<form method="post" action="/payout/settings">

<p class="hint mb-3">
  Choose how you want to receive your <strong>earnings</strong>.
</p>

<!-- Interac -->
<div class="method active" data-method="interac">
  <div class="method-title">
    <input type="radio" name="method" value="interac" checked>
    Interac e-Transfer (Canada)
  </div>
  <div class="field">
    <input name="interac_destination" placeholder="Email or phone number">
  </div>
  <label class="mt-2">
    <input type="checkbox" name="auto_deposit">
    Enable auto-deposit
  </label>
</div>

<!-- PayPal -->
<div class="method" data-method="paypal">
  <div class="method-title">
    <input type="radio" name="method" value="paypal">
    PayPal
  </div>
  <div class="field d-none">
    <input name="paypal_email" placeholder="PayPal email">
  </div>
</div>

<!-- Wise -->
<div class="method" data-method="wise">
  <div class="method-title">
    <input type="radio" name="method" value="wise">
    Wise
  </div>
  <div class="field d-none">
    <input name="wise_iban" placeholder="IBAN">
  </div>
</div>

<div class="field mt-3">
  <select name="currency">
    <option value="CAD">CAD</option>
    <option value="USD">USD</option>
    <option value="EUR">EUR</option>
  </select>
</div>

<button class="btn btn-primary mt-3">Save payout preference</button>
</form>
{% endif %}

</div>
{% endblock %}

{% block scripts %}
<script>
(function(){
  const methods = document.querySelectorAll(".method");
  const radios = document.querySelectorAll("input[name=method]");

  radios.forEach(radio => {
    radio.addEventListener("change", () => {
      methods.forEach(m => {
        const active = m.dataset.method === radio.value;
        m.classList.toggle("active", active);
        m.querySelectorAll(".field").forEach(f => {
          f.classList.toggle("d-none", !active);
        });
      });
    });
  });
})();
</script>
{% endblock %}
