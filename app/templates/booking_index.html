{# app/templates/booking_index.html #}
{% extends "base.html" %}

{% block content %}
<div class="container-fluid">

<style>
/* ====== GLASS CARD STYLE ====== */
.booking-card {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 14px;
    background: rgba(255,255,255,0.55);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
    border-radius: 18px;
    margin-bottom: 12px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.06);
}

.booking-thumb {
    width: 64px;
    height: 64px;
    border-radius: 14px;
    overflow: hidden;
    background:#f1f1f1;
    flex-shrink: 0;
}

.booking-thumb img {
    width:100%;
    height:100%;
    object-fit:cover;
}

.booking-info .title {
    font-weight:700;
    font-size:16px;
}

.booking-info .status {
    color:#4e8df6;
    font-size:14px;
    font-weight:600;
}

/* EMPTY IMAGE */
.empty-box{padding:24px 8px;text-align:center;}
.empty-box img{
  display:block;margin:10px auto;max-width:320px;width:76%;
  height:auto;object-fit:contain;opacity:.98;
}

/* ===== PHONE FIX ===== */
@media (max-width: 768px) {
    header.topbar,
    .m-top-tabs,
    .notif-panels,
    .search-wrapper,
    .page-header {
        display: none !important;
    }
    body.has-tabbar{
        padding-top: 0 !important;
    }
}
</style>

{% set EMPTY_IMG = (url_for('static', path='photo/xon.png') if view=='renter'
                    else url_for('static', path='photo/ron.png')) %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h4>{{ title }}</h4>
  <div class="btn-group">
    <a class="btn btn-sm {% if view=='renter' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="/bookings?view=renter">As renter</a>
    <a class="btn btn-sm {% if view=='owner' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="/bookings?view=owner">As owner</a>
  </div>
</div>

{% if bookings and bookings|length %}
  {% for b in bookings %}
    <a class="booking-card text-decoration-none text-dark" href="/bookings/flow/{{ b.id }}">

        <div class="booking-thumb">
            <img src="{{ b.item.image_path }}"
                 referrerpolicy="no-referrer"
                 onerror="this.src='/static/placeholder.png'">
        </div>

        <div class="booking-info">
            <div class="title">Booking #{{ b.id }}</div>
            <div class="status">Status: {{ b.status }}</div>
            <div class="text-muted small">
                {{ b.start_date }} â†’ {{ b.end_date }}
                ({{ b.days }} days)
            </div>
        </div>

        <i class="bi bi-chevron-right ms-auto"></i>
    </a>
  {% endfor %}
{% else %}
  <div class="empty-box">
    <img src="{{ EMPTY_IMG }}" alt="">
  </div>
{% endif %}

</div>
{% endblock %}
