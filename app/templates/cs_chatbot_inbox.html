{% extends "base.html" %}
{% block content %}

<div class="page">
  <h2 class="mt-4 mb-3">ðŸ¤– Chatbot â€” CS Inbox</h2>

  <!-- New Tickets -->
  <h3 class="mt-4">ðŸ†• New / Unassigned</h3>
  {% set items = data.new | selectattr('queue', 'equalto', 'cs_chatbot') | list %}
  {% if items %}
    <div class="list-group mt-2">
      {% for t in items %}
        <a href="/cs/chatbot/ticket/{{ t.id }}" class="list-group-item list-group-item-action">
          <div class="d-flex justify-content-between">
            <strong>#{{ t.id }} â€” {{ t.subject }}</strong>
            <span>{{ t.last_msg_at or t.created_at }}</span>
          </div>
          <div class="text-muted small">
            From: {{ t.user.full_name }}
          </div>
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted">No new chatbot tickets.</p>
  {% endif %}

  <!-- In Review -->
  <h3 class="mt-4">ðŸ“‚ In Review</h3>
  {% set items = data.in_review | selectattr('queue', 'equalto', 'cs_chatbot') | list %}
  {% if items %}
    <div class="list-group mt-2">
      {% for t in items %}
        <a href="/cs/chatbot/ticket/{{ t.id }}" class="list-group-item list-group-item-action">
          <strong>#{{ t.id }} â€” {{ t.subject }}</strong>
          <div class="text-muted small">Assigned</div>
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted">No chatbot tickets in review.</p>
  {% endif %}

  <!-- Resolved -->
  <h3 class="mt-4">âœ… Resolved</h3>
  {% set items = data.resolved | selectattr('queue', 'equalto', 'cs_chatbot') | list %}
  {% if items %}
    <div class="list-group mt-2">
      {% for t in items %}
        <a href="/cs/chatbot/ticket/{{ t.id }}" class="list-group-item list-group-item-action">
          <strong>#{{ t.id }} â€” {{ t.subject }}</strong>
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted">No resolved chatbot tickets.</p>
  {% endif %}
</div>

{% endblock %}
